<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>منيو المطعم - Offline</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{margin:0;font-family:Tahoma;background:#f5f5f5}
header{background:#333;color:#fff;text-align:center;padding:20px;font-size:26px}
.category{background:#d62828;color:#fff;padding:10px;margin:10px;border-radius:10px;cursor:pointer}
.item{background:#fff;margin:10px;padding:10px;border-radius:10px;cursor:pointer}
.details-popup{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.6);justify-content:center;align-items:center}
.details-content{background:#fff;width:90%;max-width:400px;border-radius:12px;padding:20px}
.unit-item{text-align:center;margin-bottom:12px}
#okBtn{width:100%;background:#d62828;color:#fff;border:none;padding:12px;border-radius:10px;font-size:18px}
</style>
</head>

<body>

<header>مطعم واحة دمشق (Offline)</header>
<div id="categories"></div>
<div id="items"></div>

<div class="details-popup" id="popup">
  <div class="details-content">
    <div id="popupContent"></div>
    <button id="okBtn">موافق</button>
  </div>
</div>

<script>
const data = JSON.parse(localStorage.getItem("offlineMenu"));
if (!data) {
    document.body.innerHTML = "<h2 style='text-align:center'>لا توجد بيانات محفوظة</h2>";
    throw "";
}

const categoriesDiv = document.getElementById("categories");
const itemsDiv = document.getElementById("items");
const popup = document.getElementById("popup");
const popupContent = document.getElementById("popupContent");

document.getElementById("okBtn").onclick = () => popup.style.display = "none";

data.categories.forEach(c => {
    const d = document.createElement("div");
    d.className = "category";
    d.innerText = c.nameA;
    d.onclick = () => showItems(c.id);
    categoriesDiv.appendChild(d);
});

function showItems(catId) {
    itemsDiv.innerHTML = "";
    data.items.filter(i => i.categoryId === catId).forEach(i => {
        const d = document.createElement("div");
        d.className = "item";
        d.innerText = i.nameA;
        d.onclick = () => showUnits(i);
        itemsDiv.appendChild(d);
    });
}

function showUnits(item) {
    popup.style.display = "flex";
    popupContent.innerHTML = `<h3>${item.nameA}</h3>`;

    (data.units[item.id] || []).forEach(u => {
        popupContent.innerHTML += `
            <div class="unit-item">
                <b>${u.unitName}</b><br>
                السعر: ${u.price} جنيه
            </div>`;
    });
}
</script>

</body>
</html>
